{"version":3,"sources":["api/api.ts","components/ConvertButton.tsx","components/UrlInput.tsx","components/ConvertView.tsx","components/Converter.tsx","components/AvailableDownloads.tsx","assets/loadcat.gif","components/LoadingView.tsx","components/Header.tsx","App.tsx","index.tsx"],"names":["Format","SERVER_URL","window","location","protocol","hostname","requestDownload","url","format","a","axios","post","res","data","id","identifier","endpoint","get","listDownloads","deleteDownload","fileName","ConvertButton","onClick","error","Button","disabled","color","variant","UrlInput","setUrl","onEnter","className","TextField","onKeyDown","event","key","label","onChange","target","value","helperText","ConverterView","onConvert","React","useState","asVideo","setAsVideo","youtubeDlApi","mp4","mp3","useMemo","maybeUrl","URL","_","isValidHttpUrl","FormControlLabel","control","Checkbox","checked","currentState","theme","createMuiTheme","palette","primary","main","blue","text","secondary","typography","button","fontWeight","Converter","downloadId","href","ThemeProvider","ConvertView","AvailableDownloads","props","availableDownloads","setAvailableDownloads","selected","setSelected","onToggle","includes","newSelected","splice","indexOf","push","onDownload","downloadUrl","getDownloadUrl","open","onDelete","then","downloads","useEffect","length","List","sx","width","maxWidth","bgcolor","map","ListItem","secondaryAction","IconButton","aria-label","disablePadding","ListItemButton","role","undefined","dense","ListItemIcon","edge","tabIndex","disableRipple","inputProps","ListItemText","LoadingView","useParams","status","setStatus","intervalId","setInterval","downloadStatus","clearInterval","info","is_playlist","playlist_index","playlist_count","src","loadCat","alt","LinearProgress","style","margin","Header","to","App","path","element","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.ffeb6910.chunk.js","sourcesContent":["import axios from \"axios\";\n\nconst SERVER_PORT = 5000;\nconst SERVER_URL = `${window.location.protocol}//${window.location.hostname}:5000`;\n\nexport enum Format {\n  mp3 = \"mp3\",\n  mp4 = \"mp4\",\n}\n\nexport type DownloadStatus = {\n  status: string;\n  info: string;\n  is_playlist: boolean;\n  playlist_index: number;\n  playlist_count: number;\n};\n\nexport function getDownloadUrl(fileName: string) {\n  return `${SERVER_URL}/downloads/${fileName}`;\n}\n\nexport async function requestDownload(\n  url: string,\n  format: Format\n): Promise<string> {\n  const endpoint = \"/download/request\";\n  const res = await axios.post(`${SERVER_URL}${endpoint}`, { url, format });\n  return res.data.id;\n}\n\nexport async function getDownloadStatus(\n  identifier: string\n): Promise<DownloadStatus> {\n  const endpoint = `/downloads/${identifier}/status`;\n  const res = await axios.get(`${SERVER_URL}${endpoint}`);\n  return res.data;\n}\n\nexport async function listDownloads(): Promise<string[]> {\n  const endpoint = \"/downloads\";\n  const res = await axios.get(`${SERVER_URL}${endpoint}`);\n  return res.data;\n}\n\nexport async function deleteDownload(fileName: string) {\n  const endpoint = `/downloads/${fileName}/delete`;\n  await axios.get(`${SERVER_URL}${endpoint}`);\n}\n","import React from \"react\";\nimport Button from \"@material-ui/core/Button\";\n\ntype Props = {\n  onClick: () => void;\n  error: boolean;\n};\n\nexport default function ConvertButton({ onClick, error }: Props) {\n  return (\n    <Button\n      disabled={error}\n      id=\"convert-button\"\n      color=\"primary\"\n      onClick={onClick}\n      variant=\"contained\"\n    >\n      Convert\n    </Button>\n  );\n}\n","import React from \"react\";\nimport TextField from \"@material-ui/core/TextField\";\n\ntype Props = {\n  setUrl: (input: string) => void;\n  onEnter: () => void;\n  error: boolean;\n};\n\nexport default function UrlInput({ setUrl, onEnter, error }: Props) {\n  const onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setUrl(event.target.value);\n  };\n\n  const onKeyPress = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === \"Enter\") {\n      onEnter();\n    }\n  };\n\n  return (\n    <div className=\"UrlInput\">\n      <TextField\n        className=\"UrlTextField\"\n        error={error}\n        onKeyDown={onKeyPress}\n        id=\"url-input\"\n        label=\"Video URL\"\n        onChange={onChange}\n        variant=\"outlined\"\n        helperText={\n          \"Enter some URL (e.g. https://www.youtube.com/watch?v=dQw4w9WgXcQ) \"\n        }\n      />\n    </div>\n  );\n}\n","import React from \"react\";\nimport * as youtubeDlApi from \"../api/api\";\n\nimport FormControlLabel from \"@mui/material/FormControlLabel\";\nimport Checkbox from \"@mui/material/Checkbox\";\n\nimport ConvertButton from \"./ConvertButton\";\nimport UrlInput from \"./UrlInput\";\n\ntype Props = {\n  onConvert: (url: string, format: youtubeDlApi.Format) => void;\n};\n\nfunction isValidHttpUrl(maybeUrl: string): boolean {\n  let url;\n  try {\n    url = new URL(maybeUrl);\n  } catch (_) {\n    return false;\n  }\n  return url.protocol === \"http:\" || url.protocol === \"https:\";\n}\n\nfunction ConverterView({ onConvert }: Props) {\n  const [url, setUrl] = React.useState(\"\");\n  const [asVideo, setAsVideo] = React.useState(false);\n\n  const onClick = () => {\n    const format = asVideo ? youtubeDlApi.Format.mp4 : youtubeDlApi.Format.mp3;\n    onConvert(url, format);\n  };\n\n  const error = React.useMemo(\n    () => !isValidHttpUrl(url) && !(url === \"\"),\n    [url]\n  );\n\n  const onToggleAsVideo = () => {\n    setAsVideo((currentState) => !currentState);\n  };\n\n  return (\n    <div className=\"InputView\">\n      <p className=\"InsertText\">Please insert url</p>\n      <UrlInput error={error} setUrl={setUrl} onEnter={onClick} />\n      <FormControlLabel\n        control={<Checkbox checked={asVideo} onChange={onToggleAsVideo} />}\n        label=\"As video\"\n      />\n      <ConvertButton error={error} onClick={onClick} />\n    </div>\n  );\n}\n\nexport default ConverterView;\n","import React from \"react\";\nimport * as youtubeDlApi from \"../api/api\";\n\nimport { createMuiTheme, ThemeProvider } from \"@material-ui/core/styles\";\nimport { blue, red } from \"@material-ui/core/colors\";\nimport ConvertView from \"./ConvertView\";\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: blue[500],\n    },\n    text: {\n      secondary: \"rgba(255,255,255,0.82)\",\n    },\n  },\n  typography: {\n    button: {\n      fontWeight: 600,\n    },\n  },\n});\n\nfunction Converter() {\n  async function onConvert(url: string, format: youtubeDlApi.Format) {\n    const downloadId = await youtubeDlApi.requestDownload(url, format);\n    window.location.href = `/view/downloads/${downloadId}`;\n  }\n\n  return (\n    <ThemeProvider theme={theme}>\n      <div className=\"Converter\">\n        <ConvertView onConvert={onConvert} />\n      </div>\n    </ThemeProvider>\n  );\n}\n\nexport default Converter;\n","import React from \"react\";\nimport { listDownloads, deleteDownload, getDownloadUrl } from \"../api/api\";\n\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemButton from \"@mui/material/ListItemButton\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport Checkbox from \"@mui/material/Checkbox\";\nimport IconButton from \"@mui/material/IconButton\";\nimport DownloadIcon from \"@mui/icons-material/Download\";\nimport DeleteIcon from \"@mui/icons-material/Delete\";\n\ntype Props = {};\nexport default function AvailableDownloads(props: Props) {\n  const [availableDownloads, setAvailableDownloads] = React.useState<string[]>(\n    []\n  );\n  const [selected, setSelected] = React.useState<string[]>([]);\n\n  const onToggle = (fileName: string) => () => {\n    if (selected.includes(fileName)) {\n      const newSelected = [...selected];\n      newSelected.splice(selected.indexOf(fileName), 1);\n      setSelected(newSelected);\n    } else {\n      const newSelected = [...selected];\n      newSelected.push(fileName);\n      setSelected(newSelected);\n    }\n  };\n\n  const onDownload = (fileName: string) => () => {\n    const downloadUrl = getDownloadUrl(fileName);\n    window.open(downloadUrl);\n    // const link = document.createElement(\"a\");\n    // link.href = downloadUrl;\n    // link.download = fileName;\n    // link.click();\n  };\n\n  const onDelete = (fileName: string) => async () => {\n    await deleteDownload(fileName);\n    listDownloads().then((downloads) => setAvailableDownloads(downloads));\n  };\n\n  const deleteAll = () => {\n    selected.map((fileName) => deleteDownload(fileName));\n  };\n\n  React.useEffect(() => {\n    listDownloads().then((downloads) => setAvailableDownloads(downloads));\n  }, []);\n\n  if (availableDownloads.length === 0) {\n    return <div className=\"NoDownloads\">No downloads available yet. ðŸ¤·</div>;\n  }\n\n  return (\n    <div className=\"DownloadsWrapper\">\n      <List sx={{ width: \"100%\", maxWidth: 360, bgcolor: \"#c1ffebbf\" }}>\n        {availableDownloads.map((fileName) => (\n          <ListItem\n            key={fileName}\n            secondaryAction={\n              <>\n                <IconButton\n                  aria-label=\"download\"\n                  onClick={onDownload(fileName)}\n                >\n                  <DownloadIcon />\n                </IconButton>\n                <IconButton aria-label=\"delete\" onClick={onDelete(fileName)}>\n                  <DeleteIcon />\n                </IconButton>\n              </>\n            }\n            disablePadding\n          >\n            <ListItemButton role={undefined} onClick={onToggle(fileName)} dense>\n              <ListItemIcon>\n                <Checkbox\n                  edge=\"start\"\n                  checked={selected.includes(fileName)}\n                  tabIndex={-1}\n                  disableRipple\n                  inputProps={{ \"aria-labelledby\": fileName }}\n                />\n              </ListItemIcon>\n              <ListItemText id={fileName} primary={fileName} />\n            </ListItemButton>\n          </ListItem>\n        ))}\n      </List>\n    </div>\n  );\n}\n","export default __webpack_public_path__ + \"static/media/loadcat.1a586006.gif\";","import React from \"react\";\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\nimport * as youtubeDlApi from \"../api/api\";\nimport loadCat from \"../assets/loadcat.gif\";\nimport { useParams } from \"react-router-dom\";\n\nfunction LoadingView() {\n  const params = useParams();\n  const downloadId = params.downloadId;\n  const [status, setStatus] =\n    React.useState<youtubeDlApi.DownloadStatus | null>(null);\n\n  React.useEffect(() => {\n    const pollStatus = () => {\n      if (downloadId) {\n        youtubeDlApi\n          .getDownloadStatus(downloadId)\n          .then((downloadStatus) => setStatus(downloadStatus));\n      }\n    };\n\n    const intervalId = setInterval(pollStatus, 1000);\n    return () => clearInterval(intervalId);\n  }, [downloadId]);\n\n  const info = status?.is_playlist\n    ? `${status.info}  ${status.playlist_index}/${status.playlist_count}`\n    : status?.info\n    ? `${status?.info} `\n    : \"Loading\";\n\n  React.useEffect(() => {\n    if (status?.status === \"finished\") {\n      window.location.href = \"/view/downloads\";\n    }\n  }, [status]);\n\n  return (\n    <>\n      <div className=\"LoadingWrapper\">\n        <img src={loadCat} alt=\"loading_cat\" className=\"LoadingCat\" />\n        <div className=\"LoadingText\">{info || \"Loading\"}</div>\n      </div>\n      <LinearProgress style={{ margin: \"10%\", width: \"80%\" }} />\n    </>\n  );\n}\n\nexport default LoadingView;\n","import React from \"react\";\n\nimport { BrowserRouter as Router, Routes, Route, Link } from \"react-router-dom\";\n\nfunction Header() {\n  return (\n    <header className=\"Header\">\n      <Link to=\"/\">Home</Link>\n      <Link to=\"/view/in_progress\">In progress</Link>\n      <Link to=\"/view/downloads\">Downloads</Link>\n    </header>\n  );\n}\n\nexport default Header;\n","import React from \"react\";\nimport \"./App.css\";\nimport { BrowserRouter as Router, Routes, Route, Link } from \"react-router-dom\";\nimport Converter from \"./components/Converter\";\nimport AvailableDownloads from \"./components/AvailableDownloads\";\nimport LoadingView from \"./components/LoadingView\";\nimport Header from \"./components/Header\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Router>\n        <Header />\n        <Routes>\n          <Route path=\"\" element={<Converter />} />\n          <Route path=\"/view/downloads\" element={<AvailableDownloads />} />\n          <Route path=\"/view/downloads/:downloadId\" element={<LoadingView />} />\n        </Routes>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}